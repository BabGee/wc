import{updateView,updatePage,updatePageGroup}from"./template.js";import{SNACKBAR_CONTEXT_SUCCESS,SNACKBAR_CONTEXT_WARNING}from"../components/snack-bar.js";export const UPDATE_SERVICE="UPDATE_SERVICE";export const UPDATE_OFFLINE="UPDATE_OFFLINE";export const OPEN_SNACKBAR="OPEN_SNACKBAR";export const CLOSE_SNACKBAR="CLOSE_SNACKBAR";export const GET_PAYLOAD="GET_PAYLOAD";import{Response}from"../core/parsers/response.js";export const getPayload=(payloadjson,template)=>dispatch=>{let response=new Response(payloadjson);response.parseAll({});dispatch({type:GET_PAYLOAD,payload:response});dispatch(loadTemplate(template))};export const navigate=path=>dispatch=>{if(!window.location.hash){window.location.href=window.location.href+"#/0/0"}let paths=path.split("/").filter(function(x){return x}),pageGroup,page,hashes=window.location.hash.split("/");pageGroup=hashes[1]||0;page=hashes[2]||0;dispatch(updatePageGroup(pageGroup));dispatch(updatePage(page));if(1<paths.length){dispatch(updateView("dialog"))}};export const loadTemplate=template=>()=>{switch(template){case"service":case"landing":case"payments":case"section":case"canvas":import(`../themes/${window.THEME}/components/templates/${template}-page.js`).then(()=>{}).catch(error=>{console.error(error)});break;default:template="view-404";import(`../themes/${window.THEME}/components/templates/${template}-page.js`).then(()=>{}).catch(error=>{console.error(error)});}};let snackbarTimer;export const showSnackbar=(message,title,context)=>dispatch=>{dispatch({type:OPEN_SNACKBAR,message:message,title:title,context:context?context:SNACKBAR_CONTEXT_SUCCESS});clearTimeout(snackbarTimer);snackbarTimer=setTimeout(()=>dispatch({type:CLOSE_SNACKBAR}),3e3)};export const updateOffline=offline=>(dispatch,getState)=>{let title,context;if(getState().app.offline!==void 0){title="Connectivity";context=offline?SNACKBAR_CONTEXT_WARNING:SNACKBAR_CONTEXT_SUCCESS;dispatch(showSnackbar("You are now "+offline?"offline!!":"online",title,context))}dispatch({type:UPDATE_OFFLINE,offline})};