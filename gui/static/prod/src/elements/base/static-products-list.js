import{utilsMixin}from"../../core/mixins/utils-mixin.js";import{dataSourceMixin}from"../../core/mixins/datasource-mixin.js";import{BaseElement}from"../../core/base-element.js";export const StaticProductsListBase=class extends utilsMixin(dataSourceMixin(BaseElement)){constructor(){super();this.selectedProduct={};this.productItems=[]}static get is(){return"static-products-list"}static get properties(){return{icon:String,dataName:{type:String,value:""},service:String,title:String,maxlength:Number,pattern:String,required:Boolean,productItems:{type:Array},selectedProduct:{type:Object,value:""},items:{type:Array,value:[]},params:{type:Object,value:""}}}dscDataName(){return this.e.defaultValue}firstUpdated(changedProperties){super.firstUpdated(changedProperties);const self=this;this.loader.then(dsc=>{self.currentGroups=self.groups;self.productItems=dsc.data;self.currentData=self.data})}static get observers(){return["_groupItems(productItems.splices,search,business)"]}_findProductItem(productId){var results=this.productItems.filter(function(item){return item.id===parseInt(productId)});return results[0]}_addCartItem(){var self=this;this.dispatchEvent(new CustomEvent("add-cart-item",{bubbles:!0,composed:!0,detail:{item:self.currentProduct,quantity:1}}))}_shouldFilterInstitutions(){var b=this._computeBusinesses();return 0<b.length}_computeBusinesses(){var self=this;const unique_array=[];for(let i=0;i<self.productItems.length;i++){const business=self.productItems[i].institution_name;if(!business){return[]}if(-1===unique_array.indexOf(business)){unique_array.push(business)}}return unique_array}_groupItems(){const self=this;if(!self.productItems.length){return}for(var items=[],row=[],i=0,item;i<self.productItems.length;i++){item=self.productItems[i];if(self.business){var query=self.business.toLowerCase(),name=item.institution_name.toLowerCase();if(query!==name){continue}}if(self.search){var query=self.search.toLowerCase(),name=item.name.toLowerCase();if(-1!==name.indexOf(query)){row.push(item)}}else{row.push(item)}if(0===row.length%4){items.push(row);row=[]}}if(row.length){items.push(row)}self.items=items}init(pElement,loader){super.init(pElement,loader);var self=this;self.required=this.e.required||pElement.min&&0<pElement.min;self.icon=pElement.icon;self.title=StaticProductsListBase.toTitleCase(pElement.name);self.params=loader.pl.paramsCopy();self.service=pElement.service;self.variable=pElement.defaultValue;self.kind=pElement.kind;self.loader=this.loadData()}};