import{fill,getFunctionName,getGlobalObject}from"../../../utils/esm/index.js";import{wrap}from"../helpers.js";var TryCatch=function(){function TryCatch(){this._ignoreOnError=0;this.name=TryCatch.id}TryCatch.prototype._wrapTimeFunction=function(original){return function(){for(var args=[],_i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}var originalCallback=args[0];args[0]=wrap(originalCallback,{mechanism:{data:{function:getFunctionName(original)},handled:!0,type:"instrument"}});return original.apply(this,args)}};TryCatch.prototype._wrapRAF=function(original){return function(callback){return original(wrap(callback,{mechanism:{data:{function:"requestAnimationFrame",handler:getFunctionName(original)},handled:!0,type:"instrument"}}))}};TryCatch.prototype._wrapEventTarget=function(target){var global=getGlobalObject(),proto=global[target]&&global[target].prototype;if(!proto||!proto.hasOwnProperty||!proto.hasOwnProperty("addEventListener")){return}fill(proto,"addEventListener",function(original){return function(eventName,fn,options){try{if("function"===typeof fn.handleEvent){fn.handleEvent=wrap(fn.handleEvent.bind(fn),{mechanism:{data:{function:"handleEvent",handler:getFunctionName(fn),target:target},handled:!0,type:"instrument"}})}}catch(err){}return original.call(this,eventName,wrap(fn,{mechanism:{data:{function:"addEventListener",handler:getFunctionName(fn),target:target},handled:!0,type:"instrument"}}),options)}});fill(proto,"removeEventListener",function(original){return function(eventName,fn,options){var callback=fn;try{callback=callback&&(callback.__sentry_wrapped__||callback)}catch(e){}return original.call(this,eventName,callback,options)}})};TryCatch.prototype._wrapXHR=function(originalSend){return function(){for(var _this=this,args=[],_i=0;_i<arguments.length;_i++){args[_i]=arguments[_i]}var xhr=this;["onload","onerror","onprogress"].forEach(function(prop){if(prop in _this&&"function"===typeof _this[prop]){fill(_this,prop,function(original){return wrap(original,{mechanism:{data:{function:prop,handler:getFunctionName(original)},handled:!0,type:"instrument"}})})}});if("onreadystatechange"in xhr&&"function"===typeof xhr.onreadystatechange){fill(xhr,"onreadystatechange",function(original){var wrapOptions={mechanism:{data:{function:"onreadystatechange",handler:getFunctionName(original)},handled:!0,type:"instrument"}};if(original.__sentry_original__){wrapOptions.mechanism.data.handler=getFunctionName(original.__sentry_original__)}return wrap(original,wrapOptions)})}return originalSend.apply(this,args)}};TryCatch.prototype.setupOnce=function(){this._ignoreOnError=this._ignoreOnError;var global=getGlobalObject();fill(global,"setTimeout",this._wrapTimeFunction.bind(this));fill(global,"setInterval",this._wrapTimeFunction.bind(this));fill(global,"requestAnimationFrame",this._wrapRAF.bind(this));if("XMLHttpRequest"in global){fill(XMLHttpRequest.prototype,"send",this._wrapXHR.bind(this))}["EventTarget","Window","Node","ApplicationCache","AudioTrackList","ChannelMergerNode","CryptoOperation","EventSource","FileReader","HTMLUnknownElement","IDBDatabase","IDBRequest","IDBTransaction","KeyOperation","MediaController","MessagePort","ModalWindow","Notification","SVGElementInstance","Screen","TextTrack","TextTrackCue","TextTrackList","WebSocket","WebSocketWorker","Worker","XMLHttpRequest","XMLHttpRequestEventTarget","XMLHttpRequestUpload"].forEach(this._wrapEventTarget.bind(this))};TryCatch.id="TryCatch";return TryCatch}();export{TryCatch};