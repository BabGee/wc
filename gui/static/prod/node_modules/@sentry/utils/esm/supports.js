import{logger}from"./logger.js";import{getGlobalObject}from"./misc.js";export function supportsErrorEvent(){try{new ErrorEvent("");return!0}catch(e){return!1}}export function supportsDOMError(){try{new DOMError("");return!0}catch(e){return!1}}export function supportsDOMException(){try{new DOMException("");return!0}catch(e){return!1}}export function supportsFetch(){if(!("fetch"in getGlobalObject())){return!1}try{new Headers;new Request("");new Response;return!0}catch(e){return!1}}function isNativeFetch(func){return func&&/^function fetch\(\)\s+\{\s+\[native code\]\s+\}$/.test(func.toString())}export function supportsNativeFetch(){if(!supportsFetch()){return!1}var global=getGlobalObject();if(isNativeFetch(global.fetch)){return!0}var result=!1,doc=global.document;if(doc){var sandbox=doc.createElement("iframe");sandbox.hidden=!0;try{doc.head.appendChild(sandbox);if(sandbox.contentWindow&&sandbox.contentWindow.fetch){result=isNativeFetch(sandbox.contentWindow.fetch)}doc.head.removeChild(sandbox)}catch(err){logger.warn("Could not create sandbox iframe for pure fetch check, bailing to window.fetch: ",err)}}return result}export function supportsReportingObserver(){return"ReportingObserver"in getGlobalObject()}export function supportsReferrerPolicy(){if(!supportsFetch()){return!1}try{new Request("_",{referrerPolicy:"origin"});return!0}catch(e){return!1}}export function supportsHistory(){var global=getGlobalObject(),chrome=global.chrome,isChromePackagedApp=chrome&&chrome.app&&chrome.app.runtime,hasHistoryApi="history"in global&&!!global.history.pushState&&!!global.history.replaceState;return!isChromePackagedApp&&hasHistoryApi}