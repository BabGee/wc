import{isString}from"./is.js";export function dynamicRequire(mod,request){return mod.require(request)}export function isNodeEnv(){return"[object process]"===Object.prototype.toString.call("undefined"!==typeof process?process:0)}var fallbackGlobalObject={};export function getGlobalObject(){return isNodeEnv()?global:"undefined"!==typeof window?window:"undefined"!==typeof self?self:fallbackGlobalObject}export function uuid4(){var global=getGlobalObject(),crypto=global.crypto||global.msCrypto;if(!(void 0===crypto)&&crypto.getRandomValues){var arr=new Uint16Array(8);crypto.getRandomValues(arr);arr[3]=16384|4095&arr[3];arr[4]=32768|16383&arr[4];var pad=function(num){var v=num.toString(16);while(4>v.length){v="0"+v}return v};return pad(arr[0])+pad(arr[1])+pad(arr[2])+pad(arr[3])+pad(arr[4])+pad(arr[5])+pad(arr[6])+pad(arr[7])}return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=0|16*Math.random(),v="x"===c?r:8|3&r;return v.toString(16)})}export function parseUrl(url){if(!url){return{}}var match=url.match(/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!match){return{}}var query=match[6]||"",fragment=match[8]||"";return{host:match[4],path:match[5],protocol:match[2],relative:match[5]+query+fragment}}export function getEventDescription(event){if(event.message){return event.message}if(event.exception&&event.exception.values&&event.exception.values[0]){var exception=event.exception.values[0];if(exception.type&&exception.value){return exception.type+": "+exception.value}return exception.type||exception.value||event.event_id||"<unknown>"}return event.event_id||"<unknown>"}export function consoleSandbox(callback){var global=getGlobalObject();if(!("console"in global)){return callback()}var originalConsole=global.console,wrappedLevels={};["debug","info","warn","error","log","assert"].forEach(function(level){if(level in global.console&&originalConsole[level].__sentry__){wrappedLevels[level]=originalConsole[level].__sentry_wrapped__;originalConsole[level]=originalConsole[level].__sentry_original__}});var result=callback();Object.keys(wrappedLevels).forEach(function(level){originalConsole[level]=wrappedLevels[level]});return result}export function addExceptionTypeValue(event,value,type){event.exception=event.exception||{};event.exception.values=event.exception.values||[];event.exception.values[0]=event.exception.values[0]||{};event.exception.values[0].value=event.exception.values[0].value||value||"";event.exception.values[0].type=event.exception.values[0].type||type||"Error"}export function addExceptionMechanism(event,mechanism){if(void 0===mechanism){mechanism={}}try{event.exception.values[0].mechanism=event.exception.values[0].mechanism||{};Object.keys(mechanism).forEach(function(key){event.exception.values[0].mechanism[key]=mechanism[key]})}catch(_oO){}}export function getLocationHref(){try{return document.location.href}catch(oO){return""}}export function htmlTreeAsString(elem){try{var currentElem=elem,out=[],height=0,len=0,separator=" > ",sepLength=separator.length,nextStr=void 0;while(currentElem&&height++<5){nextStr=_htmlElementAsString(currentElem);if("html"===nextStr||1<height&&len+out.length*sepLength+nextStr.length>=80){break}out.push(nextStr);len+=nextStr.length;currentElem=currentElem.parentNode}return out.reverse().join(separator)}catch(_oO){return"<unknown>"}}function _htmlElementAsString(el){var elem=el,out=[],className,classes,key,attr,i;if(!elem||!elem.tagName){return""}out.push(elem.tagName.toLowerCase());if(elem.id){out.push("#"+elem.id)}className=elem.className;if(className&&isString(className)){classes=className.split(/\s+/);for(i=0;i<classes.length;i++){out.push("."+classes[i])}}var attrWhitelist=["type","name","title","alt"];for(i=0;i<attrWhitelist.length;i++){key=attrWhitelist[i];attr=elem.getAttribute(key);if(attr){out.push("["+key+"=\""+attr+"\"]")}}return out.join("")}export function timestampWithMs(){return new Date().getTime()/1e3}var SEMVER_REGEXP=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/;export function parseSemver(input){var match=input.match(SEMVER_REGEXP)||[],major=parseInt(match[1],10),minor=parseInt(match[2],10),patch=parseInt(match[3],10);return{buildmetadata:match[5],major:isNaN(major)?void 0:major,minor:isNaN(minor)?void 0:minor,patch:isNaN(patch)?void 0:patch,prerelease:match[4]}}var defaultRetryAfter=1e3*60;export function parseRetryAfterHeader(now,header){if(!header){return defaultRetryAfter}var headerDelay=parseInt(""+header,10);if(!isNaN(headerDelay)){return 1e3*headerDelay}var headerDate=Date.parse(""+header);if(!isNaN(headerDate)){return headerDate-now}return defaultRetryAfter}var defaultFunctionName="<anonymous>";export function getFunctionName(fn){try{if(!fn||"function"!==typeof fn){return defaultFunctionName}return fn.name||defaultFunctionName}catch(e){return defaultFunctionName}}